\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 导入操作系统库}
\PY{k+kn}{import} \PY{n+nn}{os}
\PY{c+c1}{\PYZsh{} 更改工作目录}
\PY{n}{os}\PY{o}{.}\PY{n}{chdir}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D:}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{softwares}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{applied statistics}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{pythoncodelearning}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{chap2}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{sourcecode}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 导入基础计算库}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{c+c1}{\PYZsh{} 导入线性计算库}
\PY{k+kn}{from} \PY{n+nn}{scipy} \PY{k+kn}{import} \PY{n}{linalg}
\PY{c+c1}{\PYZsh{} 导入绘图库}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{import} \PY{n+nn}{matplotlib} \PY{k}{as} \PY{n+nn}{mpl}
\PY{c+c1}{\PYZsh{} 导入线性和二次判别分析工具}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{discriminant\PYZus{}analysis} \PY{k+kn}{import} \PY{n}{LinearDiscriminantAnalysis}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{discriminant\PYZus{}analysis} \PY{k+kn}{import} \PY{n}{QuadraticDiscriminantAnalysis}
\PY{c+c1}{\PYZsh{} 导入绘图库中的字体管理包}
\PY{k+kn}{from} \PY{n+nn}{matplotlib} \PY{k+kn}{import} \PY{n}{font\PYZus{}manager}
\PY{c+c1}{\PYZsh{} 导入颜色包}
\PY{k+kn}{from} \PY{n+nn}{matplotlib} \PY{k+kn}{import} \PY{n}{colors}
\PY{c+c1}{\PYZsh{} 实现中文字符正常显示}
\PY{n}{font} \PY{o}{=} \PY{n}{font\PYZus{}manager}\PY{o}{.}\PY{n}{FontProperties}\PY{p}{(}\PY{n}{fname}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C:}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{Windows}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{Fonts}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{SimKai.ttf}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 使用seaborn风格绘图}
\PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{seaborn\PYZhy{}v0\PYZus{}8}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 生成数据，来自同一个协方差阵的X，y}
\PY{k}{def} \PY{n+nf}{dataset\PYZus{}fixed\PYZus{}cov}\PY{p}{(}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Generate 2 Gaussians samples with the same covariance matrix\PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{c+c1}{\PYZsh{} 样本量和维度}
    \PY{n}{n}\PY{p}{,} \PY{n}{dim} \PY{o}{=} \PY{l+m+mi}{300}\PY{p}{,} \PY{l+m+mi}{2}
    \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
    \PY{n}{C} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.23}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.83}\PY{p}{,} \PY{l+m+mf}{0.23}\PY{p}{]}\PY{p}{]}\PY{p}{)}
    \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{r\PYZus{}}\PY{p}{[}
        \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randn}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{dim}\PY{p}{)}\PY{p}{,} \PY{n}{C}\PY{p}{)}\PY{p}{,}
        \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randn}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{dim}\PY{p}{)}\PY{p}{,} \PY{n}{C}\PY{p}{)} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,}
    \PY{p}{]}
    \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{)}\PY{p}{)}
    \PY{k}{return} \PY{n}{X}\PY{p}{,} \PY{n}{y}

\PY{c+c1}{\PYZsh{} 生成数据，来自不同协方差阵的X，y}
\PY{k}{def} \PY{n+nf}{dataset\PYZus{}cov}\PY{p}{(}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Generate 2 Gaussians samples with different covariance matrices\PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{c+c1}{\PYZsh{} 样本量和维度}
    \PY{n}{n}\PY{p}{,} \PY{n}{dim} \PY{o}{=} \PY{l+m+mi}{300}\PY{p}{,} \PY{l+m+mi}{2}
    \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
    \PY{n}{C} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{2.5}\PY{p}{,} \PY{l+m+mf}{0.7}\PY{p}{]}\PY{p}{]}\PY{p}{)} \PY{o}{*} \PY{l+m+mf}{2.0}
    \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{r\PYZus{}}\PY{p}{[}
        \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randn}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{dim}\PY{p}{)}\PY{p}{,} \PY{n}{C}\PY{p}{)}\PY{p}{,}
        \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randn}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{dim}\PY{p}{)}\PY{p}{,} \PY{n}{C}\PY{o}{.}\PY{n}{T}\PY{p}{)} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{]}\PY{p}{)}\PY{p}{,}
    \PY{p}{]}
    \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{)}\PY{p}{)}
    \PY{k}{return} \PY{n}{X}\PY{p}{,} \PY{n}{y}
\PY{c+c1}{\PYZsh{} 设置颜色}
\PY{n}{cmap} \PY{o}{=} \PY{n}{colors}\PY{o}{.}\PY{n}{LinearSegmentedColormap}\PY{p}{(}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{red\PYZus{}blue\PYZus{}classes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{p}{\PYZob{}}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{red}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.7}\PY{p}{)}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{green}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.7}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.7}\PY{p}{)}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.7}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}\PY{p}{,}
    \PY{p}{\PYZcb{}}\PY{p}{,}
\PY{p}{)}
\PY{c+c1}{\PYZsh{} 添加颜色到cm中}
\PY{n}{mpl}\PY{o}{.}\PY{n}{colormaps}\PY{o}{.}\PY{n}{register}\PY{p}{(}\PY{n}{cmap}\PY{o}{=}\PY{n}{cmap}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 绘制数据点}
\PY{k}{def} \PY{n+nf}{plot\PYZus{}data}\PY{p}{(}\PY{n}{lda}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{fig\PYZus{}index}\PY{p}{,} \PY{n}{axs}\PY{p}{)}\PY{p}{:}
    \PY{n}{ax} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{n}{fig\PYZus{}index}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{k}{if} \PY{n}{fig\PYZus{}index} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
        \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Linear Discriminant Analysis}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Data with}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{ fixed covariance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{k}{elif} \PY{n}{fig\PYZus{}index} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{:}
        \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Quadratic Discriminant Analysis}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{k}{elif} \PY{n}{fig\PYZus{}index} \PY{o}{==} \PY{l+m+mi}{3}\PY{p}{:}
        \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Data with}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{ varying covariances}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{n}{tp} \PY{o}{=} \PY{n}{y} \PY{o}{==} \PY{n}{y\PYZus{}pred}  \PY{c+c1}{\PYZsh{} True Positive}
    \PY{c+c1}{\PYZsh{} 混淆矩阵的计算}
    \PY{n}{tp0}\PY{p}{,} \PY{n}{tp1} \PY{o}{=} \PY{n}{tp}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{tp}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{X0}\PY{p}{,} \PY{n}{X1} \PY{o}{=} \PY{n}{X}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{X0\PYZus{}tp}\PY{p}{,} \PY{n}{X0\PYZus{}fp} \PY{o}{=} \PY{n}{X0}\PY{p}{[}\PY{n}{tp0}\PY{p}{]}\PY{p}{,} \PY{n}{X0}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{tp0}\PY{p}{]}
    \PY{n}{X1\PYZus{}tp}\PY{p}{,} \PY{n}{X1\PYZus{}fp} \PY{o}{=} \PY{n}{X1}\PY{p}{[}\PY{n}{tp1}\PY{p}{]}\PY{p}{,} \PY{n}{X1}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{tp1}\PY{p}{]}

    \PY{c+c1}{\PYZsh{} class 0: dots}
    \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X0\PYZus{}tp}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{X0\PYZus{}tp}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{red}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X0\PYZus{}fp}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{X0\PYZus{}fp}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{x}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}990000}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} dark red}

    \PY{c+c1}{\PYZsh{} class 1: dots}
    \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X1\PYZus{}tp}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{X1\PYZus{}tp}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}
        \PY{n}{X1\PYZus{}fp}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{X1\PYZus{}fp}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{x}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}000099}\PY{l+s+s2}{\PYZdq{}}
    \PY{p}{)}  \PY{c+c1}{\PYZsh{} dark blue}

    \PY{c+c1}{\PYZsh{} class 0 and 1 : areas}
    \PY{n}{nx}\PY{p}{,} \PY{n}{ny} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{l+m+mi}{100}
    \PY{n}{x\PYZus{}min}\PY{p}{,} \PY{n}{x\PYZus{}max} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{get\PYZus{}xlim}\PY{p}{(}\PY{p}{)}
    \PY{n}{y\PYZus{}min}\PY{p}{,} \PY{n}{y\PYZus{}max} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{get\PYZus{}ylim}\PY{p}{(}\PY{p}{)}
    \PY{n}{xx}\PY{p}{,} \PY{n}{yy} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{meshgrid}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{x\PYZus{}min}\PY{p}{,} \PY{n}{x\PYZus{}max}\PY{p}{,} \PY{n}{nx}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{y\PYZus{}min}\PY{p}{,} \PY{n}{y\PYZus{}max}\PY{p}{,} \PY{n}{ny}\PY{p}{)}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} LDA概率预测}
    \PY{n}{Z} \PY{o}{=} \PY{n}{lda}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{c\PYZus{}}\PY{p}{[}\PY{n}{xx}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{yy}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 取出为1的概率}
    \PY{n}{Z} \PY{o}{=} \PY{n}{Z}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{xx}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{pcolormesh}\PY{p}{(}
        \PY{n}{xx}\PY{p}{,} \PY{n}{yy}\PY{p}{,} \PY{n}{Z}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{red\PYZus{}blue\PYZus{}classes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
        \PY{n}{zorder}\PY{o}{=}\PY{l+m+mi}{0}
    \PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{yy}\PY{p}{,} \PY{n}{Z}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.5}\PY{p}{]}\PY{p}{,} \PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{2.0}\PY{p}{,} \PY{n}{colors}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{white}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} 平均值点，0类别}
    \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
        \PY{n}{lda}\PY{o}{.}\PY{n}{means\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
        \PY{n}{lda}\PY{o}{.}\PY{n}{means\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{*}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
        \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{yellow}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
        \PY{n}{markersize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,}
        \PY{n}{markeredgecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{grey}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{p}{)}
    \PY{c+c1}{\PYZsh{} 平均值点，1类别}
    \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
        \PY{n}{lda}\PY{o}{.}\PY{n}{means\PYZus{}}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
        \PY{n}{lda}\PY{o}{.}\PY{n}{means\PYZus{}}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{*}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
        \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{yellow}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
        \PY{n}{markersize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,}
        \PY{n}{markeredgecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{grey}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{p}{)}
    \PY{k}{return} \PY{n}{ax}

\PY{c+c1}{\PYZsh{} 绘制椭圆}
\PY{k}{def} \PY{n+nf}{plot\PYZus{}ellipse}\PY{p}{(}\PY{n}{splot}\PY{p}{,} \PY{n}{mean}\PY{p}{,} \PY{n}{cov}\PY{p}{,} \PY{n}{color}\PY{p}{)}\PY{p}{:}
    \PY{n}{v}\PY{p}{,} \PY{n}{w} \PY{o}{=} \PY{n}{linalg}\PY{o}{.}\PY{n}{eigh}\PY{p}{(}\PY{n}{cov}\PY{p}{)}
    \PY{n}{u} \PY{o}{=} \PY{n}{w}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{/} \PY{n}{linalg}\PY{o}{.}\PY{n}{norm}\PY{p}{(}\PY{n}{w}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
    \PY{n}{angle} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arctan}\PY{p}{(}\PY{n}{u}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{/} \PY{n}{u}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
    \PY{n}{angle} \PY{o}{=} \PY{l+m+mi}{180} \PY{o}{*} \PY{n}{angle} \PY{o}{/} \PY{n}{np}\PY{o}{.}\PY{n}{pi}  \PY{c+c1}{\PYZsh{} convert to degrees}
    \PY{c+c1}{\PYZsh{} filled Gaussian at 2 standard deviation}
    \PY{n}{ell} \PY{o}{=} \PY{n}{mpl}\PY{o}{.}\PY{n}{patches}\PY{o}{.}\PY{n}{Ellipse}\PY{p}{(}
        \PY{n}{mean}\PY{p}{,}
        \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{v}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{*}\PY{o}{*} \PY{l+m+mf}{0.5}\PY{p}{,}
        \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{v}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{*}\PY{o}{*} \PY{l+m+mf}{0.5}\PY{p}{,}
        \PY{n}{angle}\PY{o}{=}\PY{l+m+mi}{180} \PY{o}{+} \PY{n}{angle}\PY{p}{,}
        \PY{n}{facecolor}\PY{o}{=}\PY{n}{color}\PY{p}{,}
        \PY{n}{edgecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{black}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
        \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
    \PY{p}{)}
    \PY{n}{ell}\PY{o}{.}\PY{n}{set\PYZus{}clip\PYZus{}box}\PY{p}{(}\PY{n}{splot}\PY{o}{.}\PY{n}{bbox}\PY{p}{)}
    \PY{n}{ell}\PY{o}{.}\PY{n}{set\PYZus{}alpha}\PY{p}{(}\PY{l+m+mf}{0.2}\PY{p}{)}
    \PY{n}{splot}\PY{o}{.}\PY{n}{add\PYZus{}artist}\PY{p}{(}\PY{n}{ell}\PY{p}{)}
    \PY{n}{splot}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{p}{(}\PY{p}{)}\PY{p}{)}
    \PY{n}{splot}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 绘制协方差阵，椭圆}
\PY{k}{def} \PY{n+nf}{plot\PYZus{}lda\PYZus{}cov}\PY{p}{(}\PY{n}{lda}\PY{p}{,} \PY{n}{splot}\PY{p}{)}\PY{p}{:}
    \PY{n}{plot\PYZus{}ellipse}\PY{p}{(}
        \PY{n}{splot}\PY{p}{,} 
        \PY{n}{lda}\PY{o}{.}\PY{n}{means\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{c+c1}{\PYZsh{} 类别的样本均值}
        \PY{n}{lda}\PY{o}{.}\PY{n}{covariance\PYZus{}}\PY{p}{,} \PY{c+c1}{\PYZsh{} 类别的样本协方差阵}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{red}\PY{l+s+s2}{\PYZdq{}}
    \PY{p}{)}
    \PY{n}{plot\PYZus{}ellipse}\PY{p}{(}
        \PY{n}{splot}\PY{p}{,} 
        \PY{n}{lda}\PY{o}{.}\PY{n}{means\PYZus{}}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{c+c1}{\PYZsh{} 类别的样本均值}
        \PY{n}{lda}\PY{o}{.}\PY{n}{covariance\PYZus{}}\PY{p}{,} \PY{c+c1}{\PYZsh{} 类别的样本协方差阵}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}
    \PY{p}{)}


\PY{k}{def} \PY{n+nf}{plot\PYZus{}qda\PYZus{}cov}\PY{p}{(}\PY{n}{qda}\PY{p}{,} \PY{n}{splot}\PY{p}{)}\PY{p}{:}
    \PY{n}{plot\PYZus{}ellipse}\PY{p}{(}\PY{n}{splot}\PY{p}{,} \PY{n}{qda}\PY{o}{.}\PY{n}{means\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{qda}\PY{o}{.}\PY{n}{covariance\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{red}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plot\PYZus{}ellipse}\PY{p}{(}\PY{n}{splot}\PY{p}{,} \PY{n}{qda}\PY{o}{.}\PY{n}{means\PYZus{}}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{qda}\PY{o}{.}\PY{n}{covariance\PYZus{}}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}


\PY{c+c1}{\PYZsh{} 开始绘图}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}\PY{p}{,} \PY{n}{tight\PYZus{}layout}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Linear Discriminant Analysis vs Quadratic Discriminant Analysis}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{n}{y}\PY{o}{=}\PY{l+m+mf}{0.98}\PY{p}{,}
    \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,}
\PY{p}{)}
\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{)} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{p}{[}\PY{n}{dataset\PYZus{}fixed\PYZus{}cov}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{dataset\PYZus{}cov}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} 构造线性判别分析模型}
    \PY{n}{lda} \PY{o}{=} \PY{n}{LinearDiscriminantAnalysis}\PY{p}{(}
        \PY{n}{solver}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{svd}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{} 求解方法}
        \PY{n}{store\PYZus{}covariance}\PY{o}{=}\PY{k+kc}{True} \PY{c+c1}{\PYZsh{} 保存协方差的结果}
    \PY{p}{)}
    \PY{c+c1}{\PYZsh{} 模型拟合}
    \PY{n}{lda}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 预测，在训练集上}
    \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{lda}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 绘图}
    \PY{n}{ax} \PY{o}{=} \PY{n}{plot\PYZus{}data}\PY{p}{(}\PY{n}{lda}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{fig\PYZus{}index}\PY{o}{=}\PY{l+m+mi}{2} \PY{o}{*} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{axs}\PY{o}{=}\PY{n}{axs}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 绘制椭圆，协方差阵}
    \PY{n}{plot\PYZus{}lda\PYZus{}cov}\PY{p}{(}\PY{n}{lda}\PY{p}{,} \PY{n}{ax}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} 建立二次判别分析模型}
    \PY{n}{qda} \PY{o}{=} \PY{n}{QuadraticDiscriminantAnalysis}\PY{p}{(}\PY{n}{store\PYZus{}covariance}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 模型拟合}
    \PY{n}{qda}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 预测}
    \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{qda}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{)}
    \PY{n}{splot} \PY{o}{=} \PY{n}{plot\PYZus{}data}\PY{p}{(}\PY{n}{qda}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{fig\PYZus{}index}\PY{o}{=}\PY{l+m+mi}{2} \PY{o}{*} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{axs}\PY{o}{=}\PY{n}{axs}\PY{p}{)}
    \PY{n}{plot\PYZus{}qda\PYZus{}cov}\PY{p}{(}\PY{n}{qda}\PY{p}{,} \PY{n}{splot}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../codeimage/code1.pdf}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
